"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middlewares/with-custom-urls.ts":
/*!*****************************************!*\
  !*** ./middlewares/with-custom-urls.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   withCustomUrls: () => (/* binding */ withCustomUrls)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(middleware)/./node_modules/next/dist/esm/api/headers.js\");\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(middleware)/./node_modules/next/dist/esm/server/web/exports/next-response.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! zod */ \"(middleware)/./node_modules/zod/lib/index.mjs\");\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ~/auth */ \"(middleware)/./auth.ts\");\n/* harmony import */ var _client_generated_graphql__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ~/client/generated/graphql */ \"(middleware)/./client/generated/graphql.ts\");\n/* harmony import */ var _client_queries_get_route__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ~/client/queries/get-route */ \"(middleware)/./client/queries/get-route.ts\");\n/* harmony import */ var _client_queries_get_store_status__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ~/client/queries/get-store-status */ \"(middleware)/./client/queries/get-store-status.ts\");\n/* harmony import */ var _lib_kv__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../lib/kv */ \"(middleware)/./lib/kv/index.ts\");\n// import { cookies } from 'next/headers';\n// import { NextRequest, NextResponse } from 'next/server';\n// import { z } from 'zod';\n// import { getSessionCustomerId } from '~/auth';\n// import { StorefrontStatusType } from '~/client/generated/graphql';\n// import { getRoute } from '~/client/queries/get-route';\n// import { getStoreStatus } from '~/client/queries/get-store-status';\n// import { kv } from '../lib/kv';\n// import { type MiddlewareFactory } from './compose-middlewares';\n// type Node = Awaited<ReturnType<typeof getRoute>>;\n// interface RouteCache {\n//   node: Node;\n//   expiryTime: number;\n// }\n// const STORE_STATUS_KEY = 'storeStatus';\n// interface StorefrontStatusCache {\n//   status: StorefrontStatusType;\n//   expiryTime: number;\n// }\n// const createRewriteUrl = (path: string, request: NextRequest) => {\n//   const url = new URL(path, request.url);\n//   url.search = request.nextUrl.search;\n//   return url;\n// };\n// const StorefrontStatusCacheSchema = z.object({\n//   status: z.nativeEnum(StorefrontStatusType),\n//   expiryTime: z.number(),\n// });\n// const RouteCacheSchema = z.object({\n//   node: z.nullable(z.object({ __typename: z.string(), entityId: z.optional(z.number()) })),\n//   expiryTime: z.number(),\n// });\n// const getExistingRouteInfo = async (request: NextRequest) => {\n//   try {\n//     const pathname = request.nextUrl.pathname;\n//     const [routeCache, statusCache] = await kv.mget<RouteCache | StorefrontStatusCache>(\n//       pathname,\n//       STORE_STATUS_KEY,\n//     );\n//     if (statusCache && statusCache.expiryTime < Date.now()) {\n//       void fetch(new URL(`/api/revalidate/store-status`, request.url), {\n//         method: 'POST',\n//         headers: {\n//           'x-internal-token': process.env.BIGCOMMERCE_CUSTOMER_IMPERSONATION_TOKEN ?? '',\n//         },\n//       });\n//     }\n//     if (routeCache && routeCache.expiryTime < Date.now()) {\n//       void fetch(new URL(`/api/revalidate/route`, request.url), {\n//         method: 'POST',\n//         body: JSON.stringify({ pathname }),\n//         headers: {\n//           'x-internal-token': process.env.BIGCOMMERCE_CUSTOMER_IMPERSONATION_TOKEN ?? '',\n//         },\n//       });\n//     }\n//     const parsedRoute = RouteCacheSchema.safeParse(routeCache);\n//     const parsedStatus = StorefrontStatusCacheSchema.safeParse(statusCache);\n//     return {\n//       // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n//       node: parsedRoute.success ? (parsedRoute.data.node as Node) : undefined,\n//       status: parsedStatus.success ? parsedStatus.data.status : undefined,\n//     };\n//   } catch (error) {\n//     // eslint-disable-next-line no-console\n//     console.error(error);\n//     return {\n//       node: undefined,\n//       status: undefined,\n//     };\n//   }\n// };\n// const setKvStatus = async (status?: StorefrontStatusType | null) => {\n//   try {\n//     const expiryTime = Date.now() + 1000 * 60 * 5; // 5 minutes;\n//     await kv.set(STORE_STATUS_KEY, { status, expiryTime });\n//   } catch (error) {\n//     // eslint-disable-next-line no-console\n//     console.error(error);\n//   }\n// };\n// const setKvRoute = async (request: NextRequest, node: Node) => {\n//   try {\n//     const expiryTime = Date.now() + 1000 * 60 * 30; // 30 minutes;\n//     await kv.set(request.nextUrl.pathname, { node, expiryTime });\n//   } catch (error) {\n//     // eslint-disable-next-line no-console\n//     console.error(error);\n//   }\n// };\n// const getRouteInfo = async (request: NextRequest) => {\n//   try {\n//     let { node, status } = await getExistingRouteInfo(request);\n//     if (status === undefined) {\n//       const newStatus = await getStoreStatus();\n//       if (newStatus) {\n//         status = newStatus;\n//         await setKvStatus(status);\n//       }\n//     }\n//     if (node === undefined) {\n//       const newNode = await getRoute(request.nextUrl.pathname);\n//       node = newNode;\n//       await setKvRoute(request, node);\n//     }\n//     return { node, status };\n//   } catch (error) {\n//     // eslint-disable-next-line no-console\n//     console.error(error);\n//     return {\n//       node: undefined,\n//       status: undefined,\n//     };\n//   }\n// };\n// export const withCustomUrls: MiddlewareFactory = (next) => {\n//   return async (request, event) => {\n//     const { node, status } = await getRouteInfo(request);\n//     if (status === 'MAINTENANCE') {\n//       // 503 status code not working - https://github.com/vercel/next.js/issues/50155\n//       return NextResponse.rewrite(new URL(`/maintenance`, request.url), { status: 503 });\n//     }\n//     const customerId = await getSessionCustomerId();\n//     const cartId = cookies().get('cartId');\n//     let postfix = '';\n//     if (!request.nextUrl.search && !customerId && !cartId && request.method === 'GET') {\n//       postfix = '/static';\n//     }\n//     switch (node?.__typename) {\n//       case 'Brand': {\n//         const url = createRewriteUrl(`/brand/${node.entityId}${postfix}`, request);\n//         return NextResponse.rewrite(url);\n//       }\n//       case 'Category': {\n//         const url = createRewriteUrl(`/category/${node.entityId}${postfix}`, request);\n//         return NextResponse.rewrite(url);\n//       }\n//       case 'Product': {\n//         const url = createRewriteUrl(`/product/${node.entityId}${postfix}`, request);\n//         return NextResponse.rewrite(url);\n//       }\n//       case 'ContactPage':\n//       case 'NormalPage': {\n//         const { pathname } = new URL(request.url);\n//         const url = createRewriteUrl(`/bc-page${pathname}`, request);\n//         return NextResponse.rewrite(url);\n//       }\n//       default: {\n//         const { pathname } = new URL(request.url);\n//         if (pathname === '/' && postfix) {\n//           const url = createRewriteUrl(postfix, request);\n//           return NextResponse.rewrite(url);\n//         }\n//         return next(request, event);\n//       }\n//     }\n//   };\n// };\n// import { cookies } from 'next/headers';\n// import { NextRequest, NextResponse } from 'next/server';\n// import { z } from 'zod';\n// import { getSessionCustomerId } from '~/auth';\n// import { StorefrontStatusType } from '~/client/generated/graphql';\n// import { getRoute } from '~/client/queries/get-route';\n// import { getStoreStatus } from '~/client/queries/get-store-status';\n// import { kv } from '../lib/kv';\n// import { type MiddlewareFactory } from './compose-middlewares';\n// type Node = Awaited<ReturnType<typeof getRoute>>;\n// interface RouteCache {\n//   node: Node;\n//   expiryTime: number;\n// }\n// const STORE_STATUS_KEY = 'storeStatus';\n// interface StorefrontStatusCache {\n//   status: StorefrontStatusType;\n//   expiryTime: number;\n// }\n// const createRewriteUrl = (path: string, request: NextRequest) => {\n//   const url = new URL(path, request.url);\n//   url.search = request.nextUrl.search;\n//   return url;\n// };\n// const StorefrontStatusCacheSchema = z.object({\n//   status: z.nativeEnum(StorefrontStatusType),\n//   expiryTime: z.number(),\n// });\n// const RouteCacheSchema = z.object({\n//   node: z.nullable(z.object({ __typename: z.string(), entityId: z.optional(z.number()) })),\n//   expiryTime: z.number(),\n// });\n// const getExistingRouteInfo = async (request: NextRequest) => {\n//   try {\n//     const pathname = request.nextUrl.pathname;\n//     const [routeCache, statusCache] = await kv.mget<RouteCache | StorefrontStatusCache>(\n//       pathname,\n//       STORE_STATUS_KEY,\n//     );\n//     if (statusCache && statusCache.expiryTime < Date.now()) {\n//       void fetch(new URL(`/api/revalidate/store-status`, request.url), {\n//         method: 'POST',\n//         headers: {\n//           'x-internal-token': process.env.BIGCOMMERCE_CUSTOMER_IMPERSONATION_TOKEN ?? '',\n//         },\n//       });\n//     }\n//     if (routeCache && routeCache.expiryTime < Date.now()) {\n//       void fetch(new URL(`/api/revalidate/route`, request.url), {\n//         method: 'POST',\n//         body: JSON.stringify({ pathname }),\n//         headers: {\n//           'x-internal-token': process.env.BIGCOMMERCE_CUSTOMER_IMPERSONATION_TOKEN ?? '',\n//         },\n//       });\n//     }\n//     const parsedRoute = RouteCacheSchema.safeParse(routeCache);\n//     const parsedStatus = StorefrontStatusCacheSchema.safeParse(statusCache);\n//     return {\n//       // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n//       node: parsedRoute.success ? (parsedRoute.data.node as Node) : undefined,\n//       status: parsedStatus.success ? parsedStatus.data.status : undefined,\n//     };\n//   } catch (error) {\n//     // eslint-disable-next-line no-console\n//     console.error(error);\n//     return {\n//       node: undefined,\n//       status: undefined,\n//     };\n//   }\n// };\n// const setKvStatus = async (status?: StorefrontStatusType | null) => {\n//   try {\n//     const expiryTime = Date.now() + 1000 * 60 * 5; // 5 minutes;\n//     await kv.set(STORE_STATUS_KEY, { status, expiryTime });\n//   } catch (error) {\n//     // eslint-disable-next-line no-console\n//     console.error(error);\n//   }\n// };\n// const setKvRoute = async (request: NextRequest, node: Node) => {\n//   try {\n//     const expiryTime = Date.now() + 1000 * 60 * 30; // 30 minutes;\n//     await kv.set(request.nextUrl.pathname, { node, expiryTime });\n//   } catch (error) {\n//     // eslint-disable-next-line no-console\n//     console.error(error);\n//   }\n// };\n// const getRouteInfo = async (request: NextRequest) => {\n//   try {\n//     let { node, status } = await getExistingRouteInfo(request);\n//     if (status === undefined) {\n//       const newStatus = await getStoreStatus();\n//       if (newStatus) {\n//         status = newStatus;\n//         await setKvStatus(status);\n//       }\n//     }\n//     if (node === undefined) {\n//       const newNode = await getRoute(request.nextUrl.pathname);\n//       node = newNode;\n//       await setKvRoute(request, node);\n//     }\n//     return { node, status };\n//   } catch (error) {\n//     // eslint-disable-next-line no-console\n//     console.error(error);\n//     return {\n//       node: undefined,\n//       status: undefined,\n//     };\n//   }\n// };\n// export const withCustomUrls: MiddlewareFactory = (next) => {\n//   return async (request, event) => {\n//     const { node, status } = await getRouteInfo(request);\n//     if (status === 'MAINTENANCE') {\n//       // 503 status code not working - https://github.com/vercel/next.js/issues/50155\n//       return NextResponse.rewrite(new URL(`/maintenance`, request.url), { status: 503 });\n//     }\n//     const customerId = await getSessionCustomerId();\n//     const cartId = cookies().get('cartId');\n//     let postfix = '';\n//     if (!request.nextUrl.search && !customerId && !cartId && request.method === 'GET') {\n//       postfix = '/static';\n//     }\n//     // Rewrite / to /lookbook -- ARIZON\n//     if (request.nextUrl.pathname === '/') {\n//       return NextResponse.rewrite(new URL('/page', request.url));\n//     }\n//     switch (node?.__typename) {\n//       case 'Brand': {\n//         const url = createRewriteUrl(`/brand/${node.entityId}${postfix}`, request);\n//         return NextResponse.rewrite(url);\n//       }\n//       case 'Category': {\n//         const url = createRewriteUrl(`/category/${node.entityId}${postfix}`, request);\n//         return NextResponse.rewrite(url);\n//       }\n//       case 'Product': {\n//         const url = createRewriteUrl(`/product/${node.entityId}${postfix}`, request);\n//         return NextResponse.rewrite(url);\n//       }\n//       case 'ContactPage':\n//       case 'NormalPage': {\n//         const { pathname } = new URL(request.url);\n//         const url = createRewriteUrl(`/bc-page${pathname}`, request);\n//         return NextResponse.rewrite(url);\n//       }\n//       default: {\n//         const { pathname } = new URL(request.url);\n//         if (pathname === '/' && postfix) {\n//           const url = createRewriteUrl(postfix, request);\n//           return NextResponse.rewrite(url);\n//         }\n//         return next(request, event);\n//       }\n//     }\n//   };\n// };\n// new code\n\n\n\n\n\n\n\n\nconst STORE_STATUS_KEY = \"storeStatus\";\nconst createRewriteUrl = (path, request)=>{\n    const url = new URL(path, request.url);\n    url.search = request.nextUrl.search;\n    return url;\n};\nconst StorefrontStatusCacheSchema = zod__WEBPACK_IMPORTED_MODULE_7__.z.object({\n    status: zod__WEBPACK_IMPORTED_MODULE_7__.z.nativeEnum(_client_generated_graphql__WEBPACK_IMPORTED_MODULE_3__.StorefrontStatusType),\n    expiryTime: zod__WEBPACK_IMPORTED_MODULE_7__.z.number()\n});\nconst RouteCacheSchema = zod__WEBPACK_IMPORTED_MODULE_7__.z.object({\n    node: zod__WEBPACK_IMPORTED_MODULE_7__.z.nullable(zod__WEBPACK_IMPORTED_MODULE_7__.z.object({\n        __typename: zod__WEBPACK_IMPORTED_MODULE_7__.z.string(),\n        entityId: zod__WEBPACK_IMPORTED_MODULE_7__.z.optional(zod__WEBPACK_IMPORTED_MODULE_7__.z.number())\n    })),\n    expiryTime: zod__WEBPACK_IMPORTED_MODULE_7__.z.number()\n});\nconst getExistingRouteInfo = async (request)=>{\n    try {\n        const pathname = request.nextUrl.pathname;\n        const [routeCache, statusCache] = await _lib_kv__WEBPACK_IMPORTED_MODULE_6__.kv.mget(pathname, STORE_STATUS_KEY);\n        if (statusCache && statusCache.expiryTime < Date.now()) {\n            void fetch(new URL(`/api/revalidate/store-status`, request.url), {\n                method: \"POST\",\n                headers: {\n                    \"x-internal-token\": process.env.BIGCOMMERCE_CUSTOMER_IMPERSONATION_TOKEN ?? \"\"\n                }\n            });\n        }\n        if (routeCache && routeCache.expiryTime < Date.now()) {\n            void fetch(new URL(`/api/revalidate/route`, request.url), {\n                method: \"POST\",\n                body: JSON.stringify({\n                    pathname\n                }),\n                headers: {\n                    \"x-internal-token\": process.env.BIGCOMMERCE_CUSTOMER_IMPERSONATION_TOKEN ?? \"\"\n                }\n            });\n        }\n        const parsedRoute = RouteCacheSchema.safeParse(routeCache);\n        const parsedStatus = StorefrontStatusCacheSchema.safeParse(statusCache);\n        return {\n            // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n            node: parsedRoute.success ? parsedRoute.data.node : undefined,\n            status: parsedStatus.success ? parsedStatus.data.status : undefined\n        };\n    } catch (error) {\n        console.error(error);\n        return {\n            node: undefined,\n            status: undefined\n        };\n    }\n};\nconst setKvStatus = async (status)=>{\n    try {\n        const expiryTime = Date.now() + 1000 * 60 * 5; // 5 minutes;\n        await _lib_kv__WEBPACK_IMPORTED_MODULE_6__.kv.set(STORE_STATUS_KEY, {\n            status,\n            expiryTime\n        });\n    } catch (error) {\n        console.error(error);\n    }\n};\nconst setKvRoute = async (request, node)=>{\n    try {\n        const expiryTime = Date.now() + 1000 * 60 * 30; // 30 minutes;\n        await _lib_kv__WEBPACK_IMPORTED_MODULE_6__.kv.set(request.nextUrl.pathname, {\n            node,\n            expiryTime\n        });\n    } catch (error) {\n        console.error(error);\n    }\n};\nconst getRouteInfo = async (request)=>{\n    try {\n        let { node, status } = await getExistingRouteInfo(request);\n        if (status === undefined) {\n            const newStatus = await (0,_client_queries_get_store_status__WEBPACK_IMPORTED_MODULE_5__.getStoreStatus)();\n            if (newStatus) {\n                status = newStatus;\n                await setKvStatus(status);\n            }\n        }\n        if (node === undefined) {\n            const newNode = await (0,_client_queries_get_route__WEBPACK_IMPORTED_MODULE_4__.getRoute)(request.nextUrl.pathname);\n            node = newNode;\n            await setKvRoute(request, node);\n        }\n        return {\n            node,\n            status\n        };\n    } catch (error) {\n        console.error(error);\n        return {\n            node: undefined,\n            status: undefined\n        };\n    }\n};\nconst withCustomUrls = (next)=>{\n    return async (request, event)=>{\n        const { node, status } = await getRouteInfo(request);\n        if (status === \"MAINTENANCE\") {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_1__[\"default\"].rewrite(new URL(`/maintenance`, request.url), {\n                status: 503\n            });\n        }\n        if (request.nextUrl.pathname === \"/page\") {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_1__[\"default\"].redirect(\"http://localhost:3001/\", 301);\n        }\n        const customerId = await (0,_auth__WEBPACK_IMPORTED_MODULE_2__.getSessionCustomerId)();\n        const cartId = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)().get(\"cartId\");\n        let postfix = \"\";\n        if (!request.nextUrl.search && !customerId && !cartId && request.method === \"GET\") {\n            postfix = \"/static\";\n        }\n        switch(node?.__typename){\n            case \"Brand\":\n                {\n                    const url = createRewriteUrl(`/brand/${node.entityId}${postfix}`, request);\n                    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_1__[\"default\"].rewrite(url);\n                }\n            case \"Category\":\n                {\n                    const url = createRewriteUrl(`/category/${node.entityId}${postfix}`, request);\n                    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_1__[\"default\"].rewrite(url);\n                }\n            case \"Product\":\n                {\n                    const url = createRewriteUrl(`/product/${node.entityId}${postfix}`, request);\n                    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_1__[\"default\"].rewrite(url);\n                }\n            case \"ContactPage\":\n            case \"NormalPage\":\n                {\n                    const { pathname } = new URL(request.url);\n                    const url = createRewriteUrl(`/bc-page${pathname}`, request);\n                    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_1__[\"default\"].rewrite(url);\n                }\n            default:\n                {\n                    const { pathname } = new URL(request.url);\n                    if (pathname === \"/\" && postfix) {\n                        const url = createRewriteUrl(postfix, request);\n                        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_1__[\"default\"].rewrite(url);\n                    }\n                    return next(request, event);\n                }\n        }\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZXMvd2l0aC1jdXN0b20tdXJscy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSwwQ0FBMEM7QUFDMUMsMkRBQTJEO0FBQzNELDJCQUEyQjtBQUUzQixpREFBaUQ7QUFDakQscUVBQXFFO0FBQ3JFLHlEQUF5RDtBQUN6RCxzRUFBc0U7QUFFdEUsa0NBQWtDO0FBRWxDLGtFQUFrRTtBQUVsRSxvREFBb0Q7QUFFcEQseUJBQXlCO0FBQ3pCLGdCQUFnQjtBQUNoQix3QkFBd0I7QUFDeEIsSUFBSTtBQUVKLDBDQUEwQztBQUUxQyxvQ0FBb0M7QUFDcEMsa0NBQWtDO0FBQ2xDLHdCQUF3QjtBQUN4QixJQUFJO0FBRUoscUVBQXFFO0FBQ3JFLDRDQUE0QztBQUU1Qyx5Q0FBeUM7QUFFekMsZ0JBQWdCO0FBQ2hCLEtBQUs7QUFFTCxpREFBaUQ7QUFDakQsZ0RBQWdEO0FBQ2hELDRCQUE0QjtBQUM1QixNQUFNO0FBRU4sc0NBQXNDO0FBQ3RDLDhGQUE4RjtBQUM5Riw0QkFBNEI7QUFDNUIsTUFBTTtBQUVOLGlFQUFpRTtBQUNqRSxVQUFVO0FBQ1YsaURBQWlEO0FBRWpELDJGQUEyRjtBQUMzRixrQkFBa0I7QUFDbEIsMEJBQTBCO0FBQzFCLFNBQVM7QUFFVCxnRUFBZ0U7QUFDaEUsMkVBQTJFO0FBQzNFLDBCQUEwQjtBQUMxQixxQkFBcUI7QUFDckIsNEZBQTRGO0FBQzVGLGFBQWE7QUFDYixZQUFZO0FBQ1osUUFBUTtBQUVSLDhEQUE4RDtBQUM5RCxvRUFBb0U7QUFDcEUsMEJBQTBCO0FBQzFCLDhDQUE4QztBQUM5QyxxQkFBcUI7QUFDckIsNEZBQTRGO0FBQzVGLGFBQWE7QUFDYixZQUFZO0FBQ1osUUFBUTtBQUVSLGtFQUFrRTtBQUNsRSwrRUFBK0U7QUFFL0UsZUFBZTtBQUNmLGtGQUFrRjtBQUNsRixpRkFBaUY7QUFDakYsNkVBQTZFO0FBQzdFLFNBQVM7QUFDVCxzQkFBc0I7QUFDdEIsNkNBQTZDO0FBQzdDLDRC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T0FBT1Ysa0ZBQVlBLENBQUM2RCxPQUFPLENBQUNsRDtnQkFDOUI7WUFFQSxLQUFLO2dCQUFXO29CQUNkLE1BQU1BLE1BQU1ILGlCQUFpQixDQUFDLFNBQVMsRUFBRWMsS0FBS0ksUUFBUSxDQUFDLEVBQUV3QyxRQUFRLENBQUMsRUFBRXhEO29CQUNwRSxPQUFPVixrRkFBWUEsQ0FBQzZELE9BQU8sQ0FBQ2xEO2dCQUM5QjtZQUVBLEtBQUs7WUFDTCxLQUFLO2dCQUFjO29CQUNqQixNQUFNLEVBQUVrQixRQUFRLEVBQUUsR0FBRyxJQUFJakIsSUFBSUYsUUFBUUMsR0FBRztvQkFDeEMsTUFBTUEsTUFBTUgsaUJBQWlCLENBQUMsUUFBUSxFQUFFcUIsU0FBUyxDQUFDLEVBQUVuQjtvQkFDcEQsT0FBT1Ysa0ZBQVlBLENBQUM2RCxPQUFPLENBQUNsRDtnQkFDOUI7WUFFQTtnQkFBUztvQkFDUCxNQUFNLEVBQUVrQixRQUFRLEVBQUUsR0FBRyxJQUFJakIsSUFBSUYsUUFBUUMsR0FBRztvQkFFeEMsSUFBSWtCLGFBQWEsT0FBT3FDLFNBQVM7d0JBQy9CLE1BQU12RCxNQUFNSCxpQkFBaUIwRCxTQUFTeEQ7d0JBQ3RDLE9BQU9WLGtGQUFZQSxDQUFDNkQsT0FBTyxDQUFDbEQ7b0JBQzlCO29CQUVBLE9BQU9nRCxLQUFLakQsU0FBU2tEO2dCQUN2QjtRQUNGO0lBQ0Y7QUFDRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL21pZGRsZXdhcmVzL3dpdGgtY3VzdG9tLXVybHMudHM/NTdiYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJztcbi8vIGltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG4vLyBpbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuLy8gaW1wb3J0IHsgZ2V0U2Vzc2lvbkN1c3RvbWVySWQgfSBmcm9tICd+L2F1dGgnO1xuLy8gaW1wb3J0IHsgU3RvcmVmcm9udFN0YXR1c1R5cGUgfSBmcm9tICd+L2NsaWVudC9nZW5lcmF0ZWQvZ3JhcGhxbCc7XG4vLyBpbXBvcnQgeyBnZXRSb3V0ZSB9IGZyb20gJ34vY2xpZW50L3F1ZXJpZXMvZ2V0LXJvdXRlJztcbi8vIGltcG9ydCB7IGdldFN0b3JlU3RhdHVzIH0gZnJvbSAnfi9jbGllbnQvcXVlcmllcy9nZXQtc3RvcmUtc3RhdHVzJztcblxuLy8gaW1wb3J0IHsga3YgfSBmcm9tICcuLi9saWIva3YnO1xuXG4vLyBpbXBvcnQgeyB0eXBlIE1pZGRsZXdhcmVGYWN0b3J5IH0gZnJvbSAnLi9jb21wb3NlLW1pZGRsZXdhcmVzJztcblxuLy8gdHlwZSBOb2RlID0gQXdhaXRlZDxSZXR1cm5UeXBlPHR5cGVvZiBnZXRSb3V0ZT4+O1xuXG4vLyBpbnRlcmZhY2UgUm91dGVDYWNoZSB7XG4vLyAgIG5vZGU6IE5vZGU7XG4vLyAgIGV4cGlyeVRpbWU6IG51bWJlcjtcbi8vIH1cblxuLy8gY29uc3QgU1RPUkVfU1RBVFVTX0tFWSA9ICdzdG9yZVN0YXR1cyc7XG5cbi8vIGludGVyZmFjZSBTdG9yZWZyb250U3RhdHVzQ2FjaGUge1xuLy8gICBzdGF0dXM6IFN0b3JlZnJvbnRTdGF0dXNUeXBlO1xuLy8gICBleHBpcnlUaW1lOiBudW1iZXI7XG4vLyB9XG5cbi8vIGNvbnN0IGNyZWF0ZVJld3JpdGVVcmwgPSAocGF0aDogc3RyaW5nLCByZXF1ZXN0OiBOZXh0UmVxdWVzdCkgPT4ge1xuLy8gICBjb25zdCB1cmwgPSBuZXcgVVJMKHBhdGgsIHJlcXVlc3QudXJsKTtcblxuLy8gICB1cmwuc2VhcmNoID0gcmVxdWVzdC5uZXh0VXJsLnNlYXJjaDtcblxuLy8gICByZXR1cm4gdXJsO1xuLy8gfTtcblxuLy8gY29uc3QgU3RvcmVmcm9udFN0YXR1c0NhY2hlU2NoZW1hID0gei5vYmplY3Qoe1xuLy8gICBzdGF0dXM6IHoubmF0aXZlRW51bShTdG9yZWZyb250U3RhdHVzVHlwZSksXG4vLyAgIGV4cGlyeVRpbWU6IHoubnVtYmVyKCksXG4vLyB9KTtcblxuLy8gY29uc3QgUm91dGVDYWNoZVNjaGVtYSA9IHoub2JqZWN0KHtcbi8vICAgbm9kZTogei5udWxsYWJsZSh6Lm9iamVjdCh7IF9fdHlwZW5hbWU6IHouc3RyaW5nKCksIGVudGl0eUlkOiB6Lm9wdGlvbmFsKHoubnVtYmVyKCkpIH0pKSxcbi8vICAgZXhwaXJ5VGltZTogei5udW1iZXIoKSxcbi8vIH0pO1xuXG4vLyBjb25zdCBnZXRFeGlzdGluZ1JvdXRlSW5mbyA9IGFzeW5jIChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkgPT4ge1xuLy8gICB0cnkge1xuLy8gICAgIGNvbnN0IHBhdGhuYW1lID0gcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lO1xuXG4vLyAgICAgY29uc3QgW3JvdXRlQ2FjaGUsIHN0YXR1c0NhY2hlXSA9IGF3YWl0IGt2Lm1nZXQ8Um91dGVDYWNoZSB8IFN0b3JlZnJvbnRTdGF0dXNDYWNoZT4oXG4vLyAgICAgICBwYXRobmFtZSxcbi8vICAgICAgIFNUT1JFX1NUQVRVU19LRVksXG4vLyAgICAgKTtcblxuLy8gICAgIGlmIChzdGF0dXNDYWNoZSAmJiBzdGF0dXNDYWNoZS5leHBpcnlUaW1lIDwgRGF0ZS5ub3coKSkge1xuLy8gICAgICAgdm9pZCBmZXRjaChuZXcgVVJMKGAvYXBpL3JldmFsaWRhdGUvc3RvcmUtc3RhdHVzYCwgcmVxdWVzdC51cmwpLCB7XG4vLyAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuLy8gICAgICAgICBoZWFkZXJzOiB7XG4vLyAgICAgICAgICAgJ3gtaW50ZXJuYWwtdG9rZW4nOiBwcm9jZXNzLmVudi5CSUdDT01NRVJDRV9DVVNUT01FUl9JTVBFUlNPTkFUSU9OX1RPS0VOID8/ICcnLFxuLy8gICAgICAgICB9LFxuLy8gICAgICAgfSk7XG4vLyAgICAgfVxuXG4vLyAgICAgaWYgKHJvdXRlQ2FjaGUgJiYgcm91dGVDYWNoZS5leHBpcnlUaW1lIDwgRGF0ZS5ub3coKSkge1xuLy8gICAgICAgdm9pZCBmZXRjaChuZXcgVVJMKGAvYXBpL3JldmFsaWRhdGUvcm91dGVgLCByZXF1ZXN0LnVybCksIHtcbi8vICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4vLyAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgcGF0aG5hbWUgfSksXG4vLyAgICAgICAgIGhlYWRlcnM6IHtcbi8vICAgICAgICAgICAneC1pbnRlcm5hbC10b2tlbic6IHByb2Nlc3MuZW52LkJJR0NPTU1FUkNFX0NVU1RPTUVSX0lNUEVSU09OQVRJT05fVE9LRU4gPz8gJycsXG4vLyAgICAgICAgIH0sXG4vLyAgICAgICB9KTtcbi8vICAgICB9XG5cbi8vICAgICBjb25zdCBwYXJzZWRSb3V0ZSA9IFJvdXRlQ2FjaGVTY2hlbWEuc2FmZVBhcnNlKHJvdXRlQ2FjaGUpO1xuLy8gICAgIGNvbnN0IHBhcnNlZFN0YXR1cyA9IFN0b3JlZnJvbnRTdGF0dXNDYWNoZVNjaGVtYS5zYWZlUGFyc2Uoc3RhdHVzQ2FjaGUpO1xuXG4vLyAgICAgcmV0dXJuIHtcbi8vICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvY29uc2lzdGVudC10eXBlLWFzc2VydGlvbnNcbi8vICAgICAgIG5vZGU6IHBhcnNlZFJvdXRlLnN1Y2Nlc3MgPyAocGFyc2VkUm91dGUuZGF0YS5ub2RlIGFzIE5vZGUpIDogdW5kZWZpbmVkLFxuLy8gICAgICAgc3RhdHVzOiBwYXJzZWRTdGF0dXMuc3VjY2VzcyA/IHBhcnNlZFN0YXR1cy5kYXRhLnN0YXR1cyA6IHVuZGVmaW5lZCxcbi8vICAgICB9O1xuLy8gICB9IGNhdGNoIChlcnJvcikge1xuLy8gICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4vLyAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG5cbi8vICAgICByZXR1cm4ge1xuLy8gICAgICAgbm9kZTogdW5kZWZpbmVkLFxuLy8gICAgICAgc3RhdHVzOiB1bmRlZmluZWQsXG4vLyAgICAgfTtcbi8vICAgfVxuLy8gfTtcblxuLy8gY29uc3Qgc2V0S3ZTdGF0dXMgPSBhc3luYyAoc3RhdHVzPzogU3RvcmVmcm9udFN0YXR1c1R5cGUgfCBudWxsKSA9PiB7XG4vLyAgIHRyeSB7XG4vLyAgICAgY29uc3QgZXhwaXJ5VGltZSA9IERhdGUubm93KCkgKyAxMDAwICogNjAgKiA1OyAvLyA1IG1pbnV0ZXM7XG5cbi8vICAgICBhd2FpdCBrdi5zZXQoU1RPUkVfU1RBVFVTX0tFWSwgeyBzdGF0dXMsIGV4cGlyeVRpbWUgfSk7XG4vLyAgIH0gY2F0Y2ggKGVycm9yKSB7XG4vLyAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbi8vICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbi8vICAgfVxuLy8gfTtcblxuLy8gY29uc3Qgc2V0S3ZSb3V0ZSA9IGFzeW5jIChyZXF1ZXN0OiBOZXh0UmVxdWVzdCwgbm9kZTogTm9kZSkgPT4ge1xuLy8gICB0cnkge1xuLy8gICAgIGNvbnN0IGV4cGlyeVRpbWUgPSBEYXRlLm5vdygpICsgMTAwMCAqIDYwICogMzA7IC8vIDMwIG1pbnV0ZXM7XG5cbi8vICAgICBhd2FpdCBrdi5zZXQocmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lLCB7IG5vZGUsIGV4cGlyeVRpbWUgfSk7XG4vLyAgIH0gY2F0Y2ggKGVycm9yKSB7XG4vLyAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbi8vICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbi8vICAgfVxuLy8gfTtcblxuLy8gY29uc3QgZ2V0Um91dGVJbmZvID0gYXN5bmMgKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSA9PiB7XG4vLyAgIHRyeSB7XG4vLyAgICAgbGV0IHsgbm9kZSwgc3RhdHVzIH0gPSBhd2FpdCBnZXRFeGlzdGluZ1JvdXRlSW5mbyhyZXF1ZXN0KTtcblxuLy8gICAgIGlmIChzdGF0dXMgPT09IHVuZGVmaW5lZCkge1xuLy8gICAgICAgY29uc3QgbmV3U3RhdHVzID0gYXdhaXQgZ2V0U3RvcmVTdGF0dXMoKTtcblxuLy8gICAgICAgaWYgKG5ld1N0YXR1cykge1xuLy8gICAgICAgICBzdGF0dXMgPSBuZXdTdGF0dXM7XG4vLyAgICAgICAgIGF3YWl0IHNldEt2U3RhdHVzKHN0YXR1cyk7XG4vLyAgICAgICB9XG4vLyAgICAgfVxuXG4vLyAgICAgaWYgKG5vZGUgPT09IHVuZGVmaW5lZCkge1xuLy8gICAgICAgY29uc3QgbmV3Tm9kZSA9IGF3YWl0IGdldFJvdXRlKHJlcXVlc3QubmV4dFVybC5wYXRobmFtZSk7XG5cbi8vICAgICAgIG5vZGUgPSBuZXdOb2RlO1xuLy8gICAgICAgYXdhaXQgc2V0S3ZSb3V0ZShyZXF1ZXN0LCBub2RlKTtcbi8vICAgICB9XG5cbi8vICAgICByZXR1cm4geyBub2RlLCBzdGF0dXMgfTtcbi8vICAgfSBjYXRjaCAoZXJyb3IpIHtcbi8vICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuLy8gICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuXG4vLyAgICAgcmV0dXJuIHtcbi8vICAgICAgIG5vZGU6IHVuZGVmaW5lZCxcbi8vICAgICAgIHN0YXR1czogdW5kZWZpbmVkLFxuLy8gICAgIH07XG4vLyAgIH1cbi8vIH07XG5cbi8vIGV4cG9ydCBjb25zdCB3aXRoQ3VzdG9tVXJsczogTWlkZGxld2FyZUZhY3RvcnkgPSAobmV4dCkgPT4ge1xuLy8gICByZXR1cm4gYXN5bmMgKHJlcXVlc3QsIGV2ZW50KSA9PiB7XG4vLyAgICAgY29uc3QgeyBub2RlLCBzdGF0dXMgfSA9IGF3YWl0IGdldFJvdXRlSW5mbyhyZXF1ZXN0KTtcblxuLy8gICAgIGlmIChzdGF0dXMgPT09ICdNQUlOVEVOQU5DRScpIHtcbi8vICAgICAgIC8vIDUwMyBzdGF0dXMgY29kZSBub3Qgd29ya2luZyAtIGh0dHBzOi8vZ2l0aHViLmNvbS92ZXJjZWwvbmV4dC5qcy9pc3N1ZXMvNTAxNTVcbi8vICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmV3cml0ZShuZXcgVVJMKGAvbWFpbnRlbmFuY2VgLCByZXF1ZXN0LnVybCksIHsgc3RhdHVzOiA1MDMgfSk7XG4vLyAgICAgfVxuXG4vLyAgICAgY29uc3QgY3VzdG9tZXJJZCA9IGF3YWl0IGdldFNlc3Npb25DdXN0b21lcklkKCk7XG4vLyAgICAgY29uc3QgY2FydElkID0gY29va2llcygpLmdldCgnY2FydElkJyk7XG4vLyAgICAgbGV0IHBvc3RmaXggPSAnJztcblxuLy8gICAgIGlmICghcmVxdWVzdC5uZXh0VXJsLnNlYXJjaCAmJiAhY3VzdG9tZXJJZCAmJiAhY2FydElkICYmIHJlcXVlc3QubWV0aG9kID09PSAnR0VUJykge1xuLy8gICAgICAgcG9zdGZpeCA9ICcvc3RhdGljJztcbi8vICAgICB9XG5cbi8vICAgICBzd2l0Y2ggKG5vZGU/Ll9fdHlwZW5hbWUpIHtcbi8vICAgICAgIGNhc2UgJ0JyYW5kJzoge1xuLy8gICAgICAgICBjb25zdCB1cmwgPSBjcmVhdGVSZXdyaXRlVXJsKGAvYnJhbmQvJHtub2RlLmVudGl0eUlkfSR7cG9zdGZpeH1gLCByZXF1ZXN0KTtcblxuLy8gICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJld3JpdGUodXJsKTtcbi8vICAgICAgIH1cblxuLy8gICAgICAgY2FzZSAnQ2F0ZWdvcnknOiB7XG4vLyAgICAgICAgIGNvbnN0IHVybCA9IGNyZWF0ZVJld3JpdGVVcmwoYC9jYXRlZ29yeS8ke25vZGUuZW50aXR5SWR9JHtwb3N0Zml4fWAsIHJlcXVlc3QpO1xuXG4vLyAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmV3cml0ZSh1cmwpO1xuLy8gICAgICAgfVxuXG4vLyAgICAgICBjYXNlICdQcm9kdWN0Jzoge1xuLy8gICAgICAgICBjb25zdCB1cmwgPSBjcmVhdGVSZXdyaXRlVXJsKGAvcHJvZHVjdC8ke25vZGUuZW50aXR5SWR9JHtwb3N0Zml4fWAsIHJlcXVlc3QpO1xuXG4vLyAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmV3cml0ZSh1cmwpO1xuLy8gICAgICAgfVxuXG4vLyAgICAgICBjYXNlICdDb250YWN0UGFnZSc6XG4vLyAgICAgICBjYXNlICdOb3JtYWxQYWdlJzoge1xuLy8gICAgICAgICBjb25zdCB7IHBhdGhuYW1lIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbi8vICAgICAgICAgY29uc3QgdXJsID0gY3JlYXRlUmV3cml0ZVVybChgL2JjLXBhZ2Uke3BhdGhuYW1lfWAsIHJlcXVlc3QpO1xuXG4vLyAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmV3cml0ZSh1cmwpO1xuLy8gICAgICAgfVxuXG4vLyAgICAgICBkZWZhdWx0OiB7XG4vLyAgICAgICAgIGNvbnN0IHsgcGF0aG5hbWUgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuXG4vLyAgICAgICAgIGlmIChwYXRobmFtZSA9PT0gJy8nICYmIHBvc3RmaXgpIHtcbi8vICAgICAgICAgICBjb25zdCB1cmwgPSBjcmVhdGVSZXdyaXRlVXJsKHBvc3RmaXgsIHJlcXVlc3QpO1xuXG4vLyAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZXdyaXRlKHVybCk7XG4vLyAgICAgICAgIH1cblxuLy8gICAgICAgICByZXR1cm4gbmV4dChyZXF1ZXN0LCBldmVudCk7XG4vLyAgICAgICB9XG4vLyAgICAgfVxuLy8gICB9O1xuLy8gfTtcblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbi8vIGltcG9ydCB7IGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xuLy8gaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbi8vIGltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG4vLyBpbXBvcnQgeyBnZXRTZXNzaW9uQ3VzdG9tZXJJZCB9IGZyb20gJ34vYXV0aCc7XG4vLyBpbXBvcnQgeyBTdG9yZWZyb250U3RhdHVzVHlwZSB9IGZyb20gJ34vY2xpZW50L2dlbmVyYXRlZC9ncmFwaHFsJztcbi8vIGltcG9ydCB7IGdldFJvdXRlIH0gZnJvbSAnfi9jbGllbnQvcXVlcmllcy9nZXQtcm91dGUnO1xuLy8gaW1wb3J0IHsgZ2V0U3RvcmVTdGF0dXMgfSBmcm9tICd+L2NsaWVudC9xdWVyaWVzL2dldC1zdG9yZS1zdGF0dXMnO1xuXG4vLyBpbXBvcnQgeyBrdiB9IGZyb20gJy4uL2xpYi9rdic7XG5cbi8vIGltcG9ydCB7IHR5cGUgTWlkZGxld2FyZUZhY3RvcnkgfSBmcm9tICcuL2NvbXBvc2UtbWlkZGxld2FyZXMnO1xuXG4vLyB0eXBlIE5vZGUgPSBBd2FpdGVkPFJldHVyblR5cGU8dHlwZW9mIGdldFJvdXRlPj47XG5cbi8vIGludGVyZmFjZSBSb3V0ZUNhY2hlIHtcbi8vICAgbm9kZTogTm9kZTtcbi8vICAgZXhwaXJ5VGltZTogbnVtYmVyO1xuLy8gfVxuXG4vLyBjb25zdCBTVE9SRV9TVEFUVVNfS0VZID0gJ3N0b3JlU3RhdHVzJztcblxuLy8gaW50ZXJmYWNlIFN0b3JlZnJvbnRTdGF0dXNDYWNoZSB7XG4vLyAgIHN0YXR1czogU3RvcmVmcm9udFN0YXR1c1R5cGU7XG4vLyAgIGV4cGlyeVRpbWU6IG51bWJlcjtcbi8vIH1cblxuLy8gY29uc3QgY3JlYXRlUmV3cml0ZVVybCA9IChwYXRoOiBzdHJpbmcsIHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSA9PiB7XG4vLyAgIGNvbnN0IHVybCA9IG5ldyBVUkwocGF0aCwgcmVxdWVzdC51cmwpO1xuXG4vLyAgIHVybC5zZWFyY2ggPSByZXF1ZXN0Lm5leHRVcmwuc2VhcmNoO1xuXG4vLyAgIHJldHVybiB1cmw7XG4vLyB9O1xuXG4vLyBjb25zdCBTdG9yZWZyb250U3RhdHVzQ2FjaGVTY2hlbWEgPSB6Lm9iamVjdCh7XG4vLyAgIHN0YXR1czogei5uYXRpdmVFbnVtKFN0b3JlZnJvbnRTdGF0dXNUeXBlKSxcbi8vICAgZXhwaXJ5VGltZTogei5udW1iZXIoKSxcbi8vIH0pO1xuXG4vLyBjb25zdCBSb3V0ZUNhY2hlU2NoZW1hID0gei5vYmplY3Qoe1xuLy8gICBub2RlOiB6Lm51bGxhYmxlKHoub2JqZWN0KHsgX190eXBlbmFtZTogei5zdHJpbmcoKSwgZW50aXR5SWQ6IHoub3B0aW9uYWwoei5udW1iZXIoKSkgfSkpLFxuLy8gICBleHBpcnlUaW1lOiB6Lm51bWJlcigpLFxuLy8gfSk7XG5cbi8vIGNvbnN0IGdldEV4aXN0aW5nUm91dGVJbmZvID0gYXN5bmMgKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSA9PiB7XG4vLyAgIHRyeSB7XG4vLyAgICAgY29uc3QgcGF0aG5hbWUgPSByZXF1ZXN0Lm5leHRVcmwucGF0aG5hbWU7XG5cbi8vICAgICBjb25zdCBbcm91dGVDYWNoZSwgc3RhdHVzQ2FjaGVdID0gYXdhaXQga3YubWdldDxSb3V0ZUNhY2hlIHwgU3RvcmVmcm9udFN0YXR1c0NhY2hlPihcbi8vICAgICAgIHBhdGhuYW1lLFxuLy8gICAgICAgU1RPUkVfU1RBVFVTX0tFWSxcbi8vICAgICApO1xuXG4vLyAgICAgaWYgKHN0YXR1c0NhY2hlICYmIHN0YXR1c0NhY2hlLmV4cGlyeVRpbWUgPCBEYXRlLm5vdygpKSB7XG4vLyAgICAgICB2b2lkIGZldGNoKG5ldyBVUkwoYC9hcGkvcmV2YWxpZGF0ZS9zdG9yZS1zdGF0dXNgLCByZXF1ZXN0LnVybCksIHtcbi8vICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4vLyAgICAgICAgIGhlYWRlcnM6IHtcbi8vICAgICAgICAgICAneC1pbnRlcm5hbC10b2tlbic6IHByb2Nlc3MuZW52LkJJR0NPTU1FUkNFX0NVU1RPTUVSX0lNUEVSU09OQVRJT05fVE9LRU4gPz8gJycsXG4vLyAgICAgICAgIH0sXG4vLyAgICAgICB9KTtcbi8vICAgICB9XG5cbi8vICAgICBpZiAocm91dGVDYWNoZSAmJiByb3V0ZUNhY2hlLmV4cGlyeVRpbWUgPCBEYXRlLm5vdygpKSB7XG4vLyAgICAgICB2b2lkIGZldGNoKG5ldyBVUkwoYC9hcGkvcmV2YWxpZGF0ZS9yb3V0ZWAsIHJlcXVlc3QudXJsKSwge1xuLy8gICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbi8vICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBwYXRobmFtZSB9KSxcbi8vICAgICAgICAgaGVhZGVyczoge1xuLy8gICAgICAgICAgICd4LWludGVybmFsLXRva2VuJzogcHJvY2Vzcy5lbnYuQklHQ09NTUVSQ0VfQ1VTVE9NRVJfSU1QRVJTT05BVElPTl9UT0tFTiA/PyAnJyxcbi8vICAgICAgICAgfSxcbi8vICAgICAgIH0pO1xuLy8gICAgIH1cblxuLy8gICAgIGNvbnN0IHBhcnNlZFJvdXRlID0gUm91dGVDYWNoZVNjaGVtYS5zYWZlUGFyc2Uocm91dGVDYWNoZSk7XG4vLyAgICAgY29uc3QgcGFyc2VkU3RhdHVzID0gU3RvcmVmcm9udFN0YXR1c0NhY2hlU2NoZW1hLnNhZmVQYXJzZShzdGF0dXNDYWNoZSk7XG5cbi8vICAgICByZXR1cm4ge1xuLy8gICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9jb25zaXN0ZW50LXR5cGUtYXNzZXJ0aW9uc1xuLy8gICAgICAgbm9kZTogcGFyc2VkUm91dGUuc3VjY2VzcyA/IChwYXJzZWRSb3V0ZS5kYXRhLm5vZGUgYXMgTm9kZSkgOiB1bmRlZmluZWQsXG4vLyAgICAgICBzdGF0dXM6IHBhcnNlZFN0YXR1cy5zdWNjZXNzID8gcGFyc2VkU3RhdHVzLmRhdGEuc3RhdHVzIDogdW5kZWZpbmVkLFxuLy8gICAgIH07XG4vLyAgIH0gY2F0Y2ggKGVycm9yKSB7XG4vLyAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbi8vICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcblxuLy8gICAgIHJldHVybiB7XG4vLyAgICAgICBub2RlOiB1bmRlZmluZWQsXG4vLyAgICAgICBzdGF0dXM6IHVuZGVmaW5lZCxcbi8vICAgICB9O1xuLy8gICB9XG4vLyB9O1xuXG4vLyBjb25zdCBzZXRLdlN0YXR1cyA9IGFzeW5jIChzdGF0dXM/OiBTdG9yZWZyb250U3RhdHVzVHlwZSB8IG51bGwpID0+IHtcbi8vICAgdHJ5IHtcbi8vICAgICBjb25zdCBleHBpcnlUaW1lID0gRGF0ZS5ub3coKSArIDEwMDAgKiA2MCAqIDU7IC8vIDUgbWludXRlcztcblxuLy8gICAgIGF3YWl0IGt2LnNldChTVE9SRV9TVEFUVVNfS0VZLCB7IHN0YXR1cywgZXhwaXJ5VGltZSB9KTtcbi8vICAgfSBjYXRjaCAoZXJyb3IpIHtcbi8vICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuLy8gICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuLy8gICB9XG4vLyB9O1xuXG4vLyBjb25zdCBzZXRLdlJvdXRlID0gYXN5bmMgKHJlcXVlc3Q6IE5leHRSZXF1ZXN0LCBub2RlOiBOb2RlKSA9PiB7XG4vLyAgIHRyeSB7XG4vLyAgICAgY29uc3QgZXhwaXJ5VGltZSA9IERhdGUubm93KCkgKyAxMDAwICogNjAgKiAzMDsgLy8gMzAgbWludXRlcztcblxuLy8gICAgIGF3YWl0IGt2LnNldChyZXF1ZXN0Lm5leHRVcmwucGF0aG5hbWUsIHsgbm9kZSwgZXhwaXJ5VGltZSB9KTtcbi8vICAgfSBjYXRjaCAoZXJyb3IpIHtcbi8vICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuLy8gICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuLy8gICB9XG4vLyB9O1xuXG4vLyBjb25zdCBnZXRSb3V0ZUluZm8gPSBhc3luYyAocmVxdWVzdDogTmV4dFJlcXVlc3QpID0+IHtcbi8vICAgdHJ5IHtcbi8vICAgICBsZXQgeyBub2RlLCBzdGF0dXMgfSA9IGF3YWl0IGdldEV4aXN0aW5nUm91dGVJbmZvKHJlcXVlc3QpO1xuXG4vLyAgICAgaWYgKHN0YXR1cyA9PT0gdW5kZWZpbmVkKSB7XG4vLyAgICAgICBjb25zdCBuZXdTdGF0dXMgPSBhd2FpdCBnZXRTdG9yZVN0YXR1cygpO1xuXG4vLyAgICAgICBpZiAobmV3U3RhdHVzKSB7XG4vLyAgICAgICAgIHN0YXR1cyA9IG5ld1N0YXR1cztcbi8vICAgICAgICAgYXdhaXQgc2V0S3ZTdGF0dXMoc3RhdHVzKTtcbi8vICAgICAgIH1cbi8vICAgICB9XG5cbi8vICAgICBpZiAobm9kZSA9PT0gdW5kZWZpbmVkKSB7XG4vLyAgICAgICBjb25zdCBuZXdOb2RlID0gYXdhaXQgZ2V0Um91dGUocmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lKTtcblxuLy8gICAgICAgbm9kZSA9IG5ld05vZGU7XG4vLyAgICAgICBhd2FpdCBzZXRLdlJvdXRlKHJlcXVlc3QsIG5vZGUpO1xuLy8gICAgIH1cblxuLy8gICAgIHJldHVybiB7IG5vZGUsIHN0YXR1cyB9O1xuLy8gICB9IGNhdGNoIChlcnJvcikge1xuLy8gICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4vLyAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG5cbi8vICAgICByZXR1cm4ge1xuLy8gICAgICAgbm9kZTogdW5kZWZpbmVkLFxuLy8gICAgICAgc3RhdHVzOiB1bmRlZmluZWQsXG4vLyAgICAgfTtcbi8vICAgfVxuLy8gfTtcblxuLy8gZXhwb3J0IGNvbnN0IHdpdGhDdXN0b21VcmxzOiBNaWRkbGV3YXJlRmFjdG9yeSA9IChuZXh0KSA9PiB7XG4vLyAgIHJldHVybiBhc3luYyAocmVxdWVzdCwgZXZlbnQpID0+IHtcbi8vICAgICBjb25zdCB7IG5vZGUsIHN0YXR1cyB9ID0gYXdhaXQgZ2V0Um91dGVJbmZvKHJlcXVlc3QpO1xuXG4vLyAgICAgaWYgKHN0YXR1cyA9PT0gJ01BSU5URU5BTkNFJykge1xuLy8gICAgICAgLy8gNTAzIHN0YXR1cyBjb2RlIG5vdCB3b3JraW5nIC0gaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzL2lzc3Vlcy81MDE1NVxuLy8gICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZXdyaXRlKG5ldyBVUkwoYC9tYWludGVuYW5jZWAsIHJlcXVlc3QudXJsKSwgeyBzdGF0dXM6IDUwMyB9KTtcbi8vICAgICB9XG5cbi8vICAgICBjb25zdCBjdXN0b21lcklkID0gYXdhaXQgZ2V0U2Vzc2lvbkN1c3RvbWVySWQoKTtcbi8vICAgICBjb25zdCBjYXJ0SWQgPSBjb29raWVzKCkuZ2V0KCdjYXJ0SWQnKTtcbi8vICAgICBsZXQgcG9zdGZpeCA9ICcnO1xuXG4vLyAgICAgaWYgKCFyZXF1ZXN0Lm5leHRVcmwuc2VhcmNoICYmICFjdXN0b21lcklkICYmICFjYXJ0SWQgJiYgcmVxdWVzdC5tZXRob2QgPT09ICdHRVQnKSB7XG4vLyAgICAgICBwb3N0Zml4ID0gJy9zdGF0aWMnO1xuLy8gICAgIH1cblxuXG5cblxuXG5cblxuXG5cblxuLy8gICAgIC8vIFJld3JpdGUgLyB0byAvbG9va2Jvb2sgLS0gQVJJWk9OXG4vLyAgICAgaWYgKHJlcXVlc3QubmV4dFVybC5wYXRobmFtZSA9PT0gJy8nKSB7XG4vLyAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJld3JpdGUobmV3IFVSTCgnL3BhZ2UnLCByZXF1ZXN0LnVybCkpO1xuLy8gICAgIH1cblxuXG5cblxuXG5cblxuICAgIFxuXG4vLyAgICAgc3dpdGNoIChub2RlPy5fX3R5cGVuYW1lKSB7XG4vLyAgICAgICBjYXNlICdCcmFuZCc6IHtcbi8vICAgICAgICAgY29uc3QgdXJsID0gY3JlYXRlUmV3cml0ZVVybChgL2JyYW5kLyR7bm9kZS5lbnRpdHlJZH0ke3Bvc3RmaXh9YCwgcmVxdWVzdCk7XG5cbi8vICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZXdyaXRlKHVybCk7XG4vLyAgICAgICB9XG5cbi8vICAgICAgIGNhc2UgJ0NhdGVnb3J5Jzoge1xuLy8gICAgICAgICBjb25zdCB1cmwgPSBjcmVhdGVSZXdyaXRlVXJsKGAvY2F0ZWdvcnkvJHtub2RlLmVudGl0eUlkfSR7cG9zdGZpeH1gLCByZXF1ZXN0KTtcblxuLy8gICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJld3JpdGUodXJsKTtcbi8vICAgICAgIH1cblxuLy8gICAgICAgY2FzZSAnUHJvZHVjdCc6IHtcbi8vICAgICAgICAgY29uc3QgdXJsID0gY3JlYXRlUmV3cml0ZVVybChgL3Byb2R1Y3QvJHtub2RlLmVudGl0eUlkfSR7cG9zdGZpeH1gLCByZXF1ZXN0KTtcblxuLy8gICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJld3JpdGUodXJsKTtcbi8vICAgICAgIH1cblxuLy8gICAgICAgY2FzZSAnQ29udGFjdFBhZ2UnOlxuLy8gICAgICAgY2FzZSAnTm9ybWFsUGFnZSc6IHtcbi8vICAgICAgICAgY29uc3QgeyBwYXRobmFtZSB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4vLyAgICAgICAgIGNvbnN0IHVybCA9IGNyZWF0ZVJld3JpdGVVcmwoYC9iYy1wYWdlJHtwYXRobmFtZX1gLCByZXF1ZXN0KTtcblxuLy8gICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJld3JpdGUodXJsKTtcbi8vICAgICAgIH1cblxuLy8gICAgICAgZGVmYXVsdDoge1xuLy8gICAgICAgICBjb25zdCB7IHBhdGhuYW1lIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcblxuLy8gICAgICAgICBpZiAocGF0aG5hbWUgPT09ICcvJyAmJiBwb3N0Zml4KSB7XG4vLyAgICAgICAgICAgY29uc3QgdXJsID0gY3JlYXRlUmV3cml0ZVVybChwb3N0Zml4LCByZXF1ZXN0KTtcblxuLy8gICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmV3cml0ZSh1cmwpO1xuLy8gICAgICAgICB9XG5cbi8vICAgICAgICAgcmV0dXJuIG5leHQocmVxdWVzdCwgZXZlbnQpO1xuLy8gICAgICAgfVxuLy8gICAgIH1cbi8vICAgfTtcbi8vIH07XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuLy8gbmV3IGNvZGVcblxuaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycyc7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5cbmltcG9ydCB7IGdldFNlc3Npb25DdXN0b21lcklkIH0gZnJvbSAnfi9hdXRoJztcbmltcG9ydCB7IFN0b3JlZnJvbnRTdGF0dXNUeXBlIH0gZnJvbSAnfi9jbGllbnQvZ2VuZXJhdGVkL2dyYXBocWwnO1xuaW1wb3J0IHsgZ2V0Um91dGUgfSBmcm9tICd+L2NsaWVudC9xdWVyaWVzL2dldC1yb3V0ZSc7XG5pbXBvcnQgeyBnZXRTdG9yZVN0YXR1cyB9IGZyb20gJ34vY2xpZW50L3F1ZXJpZXMvZ2V0LXN0b3JlLXN0YXR1cyc7XG5cbmltcG9ydCB7IGt2IH0gZnJvbSAnLi4vbGliL2t2JztcblxuaW1wb3J0IHsgdHlwZSBNaWRkbGV3YXJlRmFjdG9yeSB9IGZyb20gJy4vY29tcG9zZS1taWRkbGV3YXJlcyc7XG5cbnR5cGUgTm9kZSA9IEF3YWl0ZWQ8UmV0dXJuVHlwZTx0eXBlb2YgZ2V0Um91dGU+PjtcblxuaW50ZXJmYWNlIFJvdXRlQ2FjaGUge1xuICBub2RlOiBOb2RlO1xuICBleHBpcnlUaW1lOiBudW1iZXI7XG59XG5cbmNvbnN0IFNUT1JFX1NUQVRVU19LRVkgPSAnc3RvcmVTdGF0dXMnO1xuXG5pbnRlcmZhY2UgU3RvcmVmcm9udFN0YXR1c0NhY2hlIHtcbiAgc3RhdHVzOiBTdG9yZWZyb250U3RhdHVzVHlwZTtcbiAgZXhwaXJ5VGltZTogbnVtYmVyO1xufVxuXG5jb25zdCBjcmVhdGVSZXdyaXRlVXJsID0gKHBhdGg6IHN0cmluZywgcmVxdWVzdDogTmV4dFJlcXVlc3QpID0+IHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChwYXRoLCByZXF1ZXN0LnVybCk7XG4gIHVybC5zZWFyY2ggPSByZXF1ZXN0Lm5leHRVcmwuc2VhcmNoO1xuICByZXR1cm4gdXJsO1xufTtcblxuY29uc3QgU3RvcmVmcm9udFN0YXR1c0NhY2hlU2NoZW1hID0gei5vYmplY3Qoe1xuICBzdGF0dXM6IHoubmF0aXZlRW51bShTdG9yZWZyb250U3RhdHVzVHlwZSksXG4gIGV4cGlyeVRpbWU6IHoubnVtYmVyKCksXG59KTtcblxuY29uc3QgUm91dGVDYWNoZVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgbm9kZTogei5udWxsYWJsZSh6Lm9iamVjdCh7IF9fdHlwZW5hbWU6IHouc3RyaW5nKCksIGVudGl0eUlkOiB6Lm9wdGlvbmFsKHoubnVtYmVyKCkpIH0pKSxcbiAgZXhwaXJ5VGltZTogei5udW1iZXIoKSxcbn0pO1xuXG5jb25zdCBnZXRFeGlzdGluZ1JvdXRlSW5mbyA9IGFzeW5jIChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHBhdGhuYW1lID0gcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lO1xuXG4gICAgY29uc3QgW3JvdXRlQ2FjaGUsIHN0YXR1c0NhY2hlXSA9IGF3YWl0IGt2Lm1nZXQ8Um91dGVDYWNoZSB8IFN0b3JlZnJvbnRTdGF0dXNDYWNoZT4oXG4gICAgICBwYXRobmFtZSxcbiAgICAgIFNUT1JFX1NUQVRVU19LRVksXG4gICAgKTtcblxuICAgIGlmIChzdGF0dXNDYWNoZSAmJiBzdGF0dXNDYWNoZS5leHBpcnlUaW1lIDwgRGF0ZS5ub3coKSkge1xuICAgICAgdm9pZCBmZXRjaChuZXcgVVJMKGAvYXBpL3JldmFsaWRhdGUvc3RvcmUtc3RhdHVzYCwgcmVxdWVzdC51cmwpLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ3gtaW50ZXJuYWwtdG9rZW4nOiBwcm9jZXNzLmVudi5CSUdDT01NRVJDRV9DVVNUT01FUl9JTVBFUlNPTkFUSU9OX1RPS0VOID8/ICcnLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHJvdXRlQ2FjaGUgJiYgcm91dGVDYWNoZS5leHBpcnlUaW1lIDwgRGF0ZS5ub3coKSkge1xuICAgICAgdm9pZCBmZXRjaChuZXcgVVJMKGAvYXBpL3JldmFsaWRhdGUvcm91dGVgLCByZXF1ZXN0LnVybCksIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgcGF0aG5hbWUgfSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAneC1pbnRlcm5hbC10b2tlbic6IHByb2Nlc3MuZW52LkJJR0NPTU1FUkNFX0NVU1RPTUVSX0lNUEVSU09OQVRJT05fVE9LRU4gPz8gJycsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBwYXJzZWRSb3V0ZSA9IFJvdXRlQ2FjaGVTY2hlbWEuc2FmZVBhcnNlKHJvdXRlQ2FjaGUpO1xuICAgIGNvbnN0IHBhcnNlZFN0YXR1cyA9IFN0b3JlZnJvbnRTdGF0dXNDYWNoZVNjaGVtYS5zYWZlUGFyc2Uoc3RhdHVzQ2FjaGUpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvY29uc2lzdGVudC10eXBlLWFzc2VydGlvbnNcbiAgICAgIG5vZGU6IHBhcnNlZFJvdXRlLnN1Y2Nlc3MgPyAocGFyc2VkUm91dGUuZGF0YS5ub2RlIGFzIE5vZGUpIDogdW5kZWZpbmVkLFxuICAgICAgc3RhdHVzOiBwYXJzZWRTdGF0dXMuc3VjY2VzcyA/IHBhcnNlZFN0YXR1cy5kYXRhLnN0YXR1cyA6IHVuZGVmaW5lZCxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIG5vZGU6IHVuZGVmaW5lZCxcbiAgICAgIHN0YXR1czogdW5kZWZpbmVkLFxuICAgIH07XG4gIH1cbn07XG5cbmNvbnN0IHNldEt2U3RhdHVzID0gYXN5bmMgKHN0YXR1cz86IFN0b3JlZnJvbnRTdGF0dXNUeXBlIHwgbnVsbCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGV4cGlyeVRpbWUgPSBEYXRlLm5vdygpICsgMTAwMCAqIDYwICogNTsgLy8gNSBtaW51dGVzO1xuICAgIGF3YWl0IGt2LnNldChTVE9SRV9TVEFUVVNfS0VZLCB7IHN0YXR1cywgZXhwaXJ5VGltZSB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgfVxufTtcblxuY29uc3Qgc2V0S3ZSb3V0ZSA9IGFzeW5jIChyZXF1ZXN0OiBOZXh0UmVxdWVzdCwgbm9kZTogTm9kZSkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGV4cGlyeVRpbWUgPSBEYXRlLm5vdygpICsgMTAwMCAqIDYwICogMzA7IC8vIDMwIG1pbnV0ZXM7XG4gICAgYXdhaXQga3Yuc2V0KHJlcXVlc3QubmV4dFVybC5wYXRobmFtZSwgeyBub2RlLCBleHBpcnlUaW1lIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICB9XG59O1xuXG5jb25zdCBnZXRSb3V0ZUluZm8gPSBhc3luYyAocmVxdWVzdDogTmV4dFJlcXVlc3QpID0+IHtcbiAgdHJ5IHtcbiAgICBsZXQgeyBub2RlLCBzdGF0dXMgfSA9IGF3YWl0IGdldEV4aXN0aW5nUm91dGVJbmZvKHJlcXVlc3QpO1xuXG4gICAgaWYgKHN0YXR1cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBuZXdTdGF0dXMgPSBhd2FpdCBnZXRTdG9yZVN0YXR1cygpO1xuXG4gICAgICBpZiAobmV3U3RhdHVzKSB7XG4gICAgICAgIHN0YXR1cyA9IG5ld1N0YXR1cztcbiAgICAgICAgYXdhaXQgc2V0S3ZTdGF0dXMoc3RhdHVzKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobm9kZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBuZXdOb2RlID0gYXdhaXQgZ2V0Um91dGUocmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lKTtcbiAgICAgIG5vZGUgPSBuZXdOb2RlO1xuICAgICAgYXdhaXQgc2V0S3ZSb3V0ZShyZXF1ZXN0LCBub2RlKTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBub2RlLCBzdGF0dXMgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcblxuICAgIHJldHVybiB7XG4gICAgICBub2RlOiB1bmRlZmluZWQsXG4gICAgICBzdGF0dXM6IHVuZGVmaW5lZCxcbiAgICB9O1xuICB9XG59O1xuXG5leHBvcnQgY29uc3Qgd2l0aEN1c3RvbVVybHM6IE1pZGRsZXdhcmVGYWN0b3J5ID0gKG5leHQpID0+IHtcbiAgcmV0dXJuIGFzeW5jIChyZXF1ZXN0LCBldmVudCkgPT4ge1xuICAgIGNvbnN0IHsgbm9kZSwgc3RhdHVzIH0gPSBhd2FpdCBnZXRSb3V0ZUluZm8ocmVxdWVzdCk7XG5cbiAgICBpZiAoc3RhdHVzID09PSAnTUFJTlRFTkFOQ0UnKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJld3JpdGUobmV3IFVSTChgL21haW50ZW5hbmNlYCwgcmVxdWVzdC51cmwpLCB7IHN0YXR1czogNTAzIH0pO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0Lm5leHRVcmwucGF0aG5hbWUgPT09ICcvcGFnZScpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMS8nLCAzMDEpO1xuICAgIH1cblxuICAgIGNvbnN0IGN1c3RvbWVySWQgPSBhd2FpdCBnZXRTZXNzaW9uQ3VzdG9tZXJJZCgpO1xuICAgIGNvbnN0IGNhcnRJZCA9IGNvb2tpZXMoKS5nZXQoJ2NhcnRJZCcpO1xuICAgIGxldCBwb3N0Zml4ID0gJyc7XG5cbiAgICBpZiAoIXJlcXVlc3QubmV4dFVybC5zZWFyY2ggJiYgIWN1c3RvbWVySWQgJiYgIWNhcnRJZCAmJiByZXF1ZXN0Lm1ldGhvZCA9PT0gJ0dFVCcpIHtcbiAgICAgIHBvc3RmaXggPSAnL3N0YXRpYyc7XG4gICAgfVxuXG4gICAgc3dpdGNoIChub2RlPy5fX3R5cGVuYW1lKSB7XG4gICAgICBjYXNlICdCcmFuZCc6IHtcbiAgICAgICAgY29uc3QgdXJsID0gY3JlYXRlUmV3cml0ZVVybChgL2JyYW5kLyR7bm9kZS5lbnRpdHlJZH0ke3Bvc3RmaXh9YCwgcmVxdWVzdCk7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmV3cml0ZSh1cmwpO1xuICAgICAgfVxuXG4gICAgICBjYXNlICdDYXRlZ29yeSc6IHtcbiAgICAgICAgY29uc3QgdXJsID0gY3JlYXRlUmV3cml0ZVVybChgL2NhdGVnb3J5LyR7bm9kZS5lbnRpdHlJZH0ke3Bvc3RmaXh9YCwgcmVxdWVzdCk7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmV3cml0ZSh1cmwpO1xuICAgICAgfVxuXG4gICAgICBjYXNlICdQcm9kdWN0Jzoge1xuICAgICAgICBjb25zdCB1cmwgPSBjcmVhdGVSZXdyaXRlVXJsKGAvcHJvZHVjdC8ke25vZGUuZW50aXR5SWR9JHtwb3N0Zml4fWAsIHJlcXVlc3QpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJld3JpdGUodXJsKTtcbiAgICAgIH1cblxuICAgICAgY2FzZSAnQ29udGFjdFBhZ2UnOlxuICAgICAgY2FzZSAnTm9ybWFsUGFnZSc6IHtcbiAgICAgICAgY29uc3QgeyBwYXRobmFtZSB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gICAgICAgIGNvbnN0IHVybCA9IGNyZWF0ZVJld3JpdGVVcmwoYC9iYy1wYWdlJHtwYXRobmFtZX1gLCByZXF1ZXN0KTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZXdyaXRlKHVybCk7XG4gICAgICB9XG5cbiAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgY29uc3QgeyBwYXRobmFtZSB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG5cbiAgICAgICAgaWYgKHBhdGhuYW1lID09PSAnLycgJiYgcG9zdGZpeCkge1xuICAgICAgICAgIGNvbnN0IHVybCA9IGNyZWF0ZVJld3JpdGVVcmwocG9zdGZpeCwgcmVxdWVzdCk7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZXdyaXRlKHVybCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV4dChyZXF1ZXN0LCBldmVudCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufTtcbiJdLCJuYW1lcyI6WyJjb29raWVzIiwiTmV4dFJlc3BvbnNlIiwieiIsImdldFNlc3Npb25DdXN0b21lcklkIiwiU3RvcmVmcm9udFN0YXR1c1R5cGUiLCJnZXRSb3V0ZSIsImdldFN0b3JlU3RhdHVzIiwia3YiLCJTVE9SRV9TVEFUVVNfS0VZIiwiY3JlYXRlUmV3cml0ZVVybCIsInBhdGgiLCJyZXF1ZXN0IiwidXJsIiwiVVJMIiwic2VhcmNoIiwibmV4dFVybCIsIlN0b3JlZnJvbnRTdGF0dXNDYWNoZVNjaGVtYSIsIm9iamVjdCIsInN0YXR1cyIsIm5hdGl2ZUVudW0iLCJleHBpcnlUaW1lIiwibnVtYmVyIiwiUm91dGVDYWNoZVNjaGVtYSIsIm5vZGUiLCJudWxsYWJsZSIsIl9fdHlwZW5hbWUiLCJzdHJpbmciLCJlbnRpdHlJZCIsIm9wdGlvbmFsIiwiZ2V0RXhpc3RpbmdSb3V0ZUluZm8iLCJwYXRobmFtZSIsInJvdXRlQ2FjaGUiLCJzdGF0dXNDYWNoZSIsIm1nZXQiLCJEYXRlIiwibm93IiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwicHJvY2VzcyIsImVudiIsIkJJR0NPTU1FUkNFX0NVU1RPTUVSX0lNUEVSU09OQVRJT05fVE9LRU4iLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInBhcnNlZFJvdXRlIiwic2FmZVBhcnNlIiwicGFyc2VkU3RhdHVzIiwic3VjY2VzcyIsImRhdGEiLCJ1bmRlZmluZWQiLCJlcnJvciIsImNvbnNvbGUiLCJzZXRLdlN0YXR1cyIsInNldCIsInNldEt2Um91dGUiLCJnZXRSb3V0ZUluZm8iLCJuZXdTdGF0dXMiLCJuZXdOb2RlIiwid2l0aEN1c3RvbVVybHMiLCJuZXh0IiwiZXZlbnQiLCJyZXdyaXRlIiwicmVkaXJlY3QiLCJjdXN0b21lcklkIiwiY2FydElkIiwiZ2V0IiwicG9zdGZpeCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./middlewares/with-custom-urls.ts\n");

/***/ })

});